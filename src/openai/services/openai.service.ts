// src/openai/openai.service.ts
import { Injectable, Logger } from "@nestjs/common";
import { ConfigService } from "@nestjs/config";
import { Interval } from "@nestjs/schedule";
import OpenAI from "openai";
import { ChatCompletionMessageParam } from "openai/resources";
import {
  MessageCreateParams,
  ThreadMessagesPage,
} from "openai/resources/beta/threads/messages/messages";
import { Run } from "openai/resources/beta/threads/runs/runs";
import { openaiConfig } from "src/config/openai.config";

@Injectable()
export class OpenAIService {
  private openAi: OpenAI;
  private readonly logger = new Logger("Message");

  constructor() {
    this.openAi = new OpenAI(openaiConfig());
  }

  async chatGPT(
    messages: ChatCompletionMessageParam[],
    userId?: string
  ): Promise<Record<string, string | number>> {
    try {
      const completion = await this.openAi.chat.completions.create({
        model: "gpt-4-turbo-preview",
        messages: [
          { role: "system", content: "Create answer in JSON format." },
          ...messages,
        ],
        user: userId || undefined,
        response_format: { type: "json_object" },
      });
      const response = completion.choices[0].message.content;
      console.log("üöÄ ~ OpenAIService ~ response:", response);
      return JSON.parse(response);
    } catch (err) {
      this.logger.error(err);
    }
  }

  async test() {
    return await this.chatGPT([
      {
        role: "system",
        content: `Summarise ingredients grouping it by name and summarise quantity. Response in JSON object as array of {name, metric, quantity}, for ingredients without quantity set null for metric and quantity.`,
      },
      {
        role: "user",
        content: `
    –®–ø–∏–Ω–∞—Ç: 100–≥
    –ê–≤–æ–∫–∞–¥–æ: 1/2 —à—Ç—É–∫–∏
    –°–≤–µ–∂–∏–µ —è–≥–æ–¥—ã (–º–∞–ª–∏–Ω–∞, —á–µ—Ä–Ω–∏–∫–∞, –∫–ª—É–±–Ω–∏–∫–∞): 50–≥
    –ö–æ–∑–∏–π —Å—ã—Ä: 30–≥
    –ì—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏: 15–≥
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –ë–∞–ª—å–∑–∞–º–∏—á–µ—Å–∫–∏–π —É–∫—Å—É—Å: 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –ì—Ä–µ—á–µ—Å–∫–∏–π –π–æ–≥—É—Ä—Ç: 150–≥
    –°–≤–µ–∂–∏–µ —Ñ—Ä—É–∫—Ç—ã –Ω–∞ –≤–∞—à –≤—ã–±–æ—Ä (—è–≥–æ–¥—ã, –∫—É—Å–æ—á–∫–∏ —è–±–ª–æ–∫–∞ –∏–ª–∏ –≥—Ä—É—à–∏): 50–≥
    –ì–æ—Ä—Å—Ç—å –∏–∑–º–µ–ª—å—á–µ–Ω–Ω—ã—Ö –æ—Ä–µ—Ö–æ–≤ (–≥—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏, –º–∏–Ω–¥–∞–ª—å): 15–≥
    –ú–µ–¥ –∏–ª–∏ –¥—Ä—É–≥–æ–π –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ø–æ–¥—Å–ª–∞—Å—Ç–∏—Ç–µ–ª—å –ø–æ –≤–∫—É—Å—É: 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –§–∏–ª–µ –ª–æ—Å–æ—Å—è: 150–≥
    –ö–≤–∏–Ω–æ–∞: 50–≥ (—Å—É—Ö–æ–π –≤–µ—Å)
    –û–≥—É—Ä–µ—Ü: 1 —à—Ç—É–∫–∞
    –ü–æ–º–∏–¥–æ—Ä—ã —á–µ—Ä—Ä–∏: 100–≥
    –°–ª–∞–¥–∫–∏–π –ø–µ—Ä–µ—Ü: 1 —à—Ç—É–∫–∞
    –õ–∏–º–æ–Ω: 1/2 —à—Ç—É–∫–∏ –¥–ª—è —Å–æ–∫–∞
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –∏ —Å–≤–µ–∂–∏–µ —Ç—Ä–∞–≤—ã (—É–∫—Ä–æ–ø, –±–∞–±–∏–π–∞–Ω, —Ç–∏–º—å—è–Ω) –¥–ª—è –º–∞—Ä–∏–Ω–∞–¥–∞ –∏ –∑–∞–ø—Ä–∞–≤–∫–∏
    –õ–∏—Å—Ç—å—è –∑–µ–ª–µ–Ω–æ–≥–æ —Å–∞–ª–∞—Ç–∞ (—Ä—É–∫—É–ª–∞, —à–ø–∏–Ω–∞—Ç –∏–ª–∏ —Ä–æ–º–µ–Ω) –¥–ª—è –ø–æ–¥–∞—á–∏
    –ì—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏: 15–≥
    –ú–∏–Ω–¥–∞–ª—å: 15–≥
    –ö—É—Å–æ—á–∫–∏ —Ç–µ–º–Ω–æ–≥–æ —à–æ–∫–æ–ª–∞–¥–∞ (–Ω–µ –º–µ–Ω–µ–µ 70% –∫–∞–∫–∞–æ): 10–≥
    –û–≤—Å—è–Ω–∞—è –º—É–∫–∞: 80–≥
    –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –π–æ–≥—É—Ä—Ç (–±–µ–∑ –¥–æ–±–∞–≤–æ–∫): 100–≥
    –Ø–π—Ü–æ: 1 —à—Ç—É–∫–∞
    –°–≤–µ–∂–∏–µ —è–≥–æ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–Ω–∏–∫–∞, –º–∞–ª–∏–Ω–∞): 100–≥
    –ú–µ–¥ –∏–ª–∏ –∞–≥–∞–≤—ã —Å–∏—Ä–æ–ø –¥–ª—è –ø–æ–¥—Å–ª–∞—â–∏–≤–∞–Ω–∏—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é): 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –†–∞–∑—Ä—ã—Ö–ª–∏—Ç–µ–ª—å —Ç–µ—Å—Ç–∞: 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –í–∞–Ω–∏–ª—å–Ω—ã–π —ç–∫—Å—Ç—Ä–∞–∫—Ç: 1/2 —á–∞–π–Ω–æ–π –ª–æ–∂–∫–∏
    –©–µ–ø–æ—Ç–∫–∞ —Å–æ–ª–∏
    –§–∏–ª–µ —Ñ–æ—Ä–µ–ª–∏: 150–≥
    –°–ø–∞—Ä–∂–∞: 100–≥
    –ú–æ—Ä–∫–æ–≤—å: 1 —à—Ç—É–∫–∞
    –¶—É–∫–∏–Ω–∏: 1/2 —à—Ç—É–∫–∏
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –õ–∏–º–æ–Ω: 1/2 —à—Ç—É–∫–∏
    –°–≤–µ–∂–∏–µ —Ç—Ä–∞–≤—ã (—É–∫—Ä–æ–ø, –ø–µ—Ç—Ä—É—à–∫–∞, —Ç–∏–º—å—è–Ω): –ø–æ –≤–∫—É—Å—É
    –°–æ–ª—å, —á–µ—Ä–Ω—ã–π –ø–µ—Ä–µ—Ü: –ø–æ –≤–∫—É—Å—É
    –ì—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏: 20–≥
    –ú–∏–Ω–¥–∞–ª—å: 20–≥
    –°–µ–º–µ—á–∫–∏ —Ç—ã–∫–≤—ã: 10–≥
    –°–µ–º–µ—á–∫–∏ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫–∞: 10–≥
    –ò–∑—é–º: 20–≥
    –°—É—à–µ–Ω—ã–µ –∫—É—Å–æ—á–∫–∏ –∞–±—Ä–∏–∫–æ—Å–∞ –∏–ª–∏ —è–±–ª–æ–∫–∞: 20–≥
    –ö–∏–Ω–æ–∞: 60–≥ (—Å—É—Ö–æ–π –≤–µ—Å)
    –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ (–±–µ–∑ –∫–æ–∂–∏): 150–≥
    –ê–≤–æ–∫–∞–¥–æ: 1/2 —à—Ç—É–∫–∏
    –°–∞–ª–∞—Ç —Ä–æ–º–µ–Ω –∏–ª–∏ —à–ø–∏–Ω–∞—Ç: 1 –≥–æ—Ä—Å—Ç—å
    –ß–µ—Ä—Ä–∏ –ø–æ–º–∏–¥–æ—Ä—ã: 5-6 —à—Ç—É–∫
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–æ–∫ –ª–∏–º–æ–Ω–∞: 2 —Å—Ç–æ–ª–æ–≤—ã–µ –ª–æ–∂–∫–∏
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü, –ø—Ä–∏–ø—Ä–∞–≤—ã –ø–æ –≤–∫—É—Å—É
    –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –π–æ–≥—É—Ä—Ç (–±–µ–∑ –¥–æ–±–∞–≤–æ–∫): 150–≥
    –°–≤–µ–∂–∏–µ —Ñ—Ä—É–∫—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —è–≥–æ–¥—ã, –∫—É—Å–æ—á–∫–∏ –º–∞–Ω–≥–æ –∏–ª–∏ –∫–∏–≤–∏): 50–≥
    –ú–µ–¥ –∏–ª–∏ –¥—Ä—É–≥–æ–π –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ø–æ–¥—Å–ª–∞—Å—Ç–∏—Ç–µ–ª—å –ø–æ –≤–∫—É—Å—É: 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –õ—å–Ω—è–Ω–æ–µ —Å–µ–º—è –∏–ª–∏ —Å–µ–º–µ–Ω–∞ —á–∏–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∏—â–µ–≤—ã—Ö –≤–æ–ª–æ–∫–æ–Ω: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –¢–≤–æ—Ä–æ–≥ –Ω–µ–∂–∏—Ä–Ω—ã–π: 200–≥
    –Ø–π—Ü–æ: 1 —à—Ç—É–∫–∞
    –¶–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–∞—è –º—É–∫–∞ (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–≤—Å—è–Ω—É—é –∏–ª–∏ –ª—é–±—É—é –¥—Ä—É–≥—É—é –Ω–∞ –≤–∞—à –≤—ã–±–æ—Ä): 2 —Å—Ç–æ–ª–æ–≤—ã–µ –ª–æ–∂–∫–∏
    –í–∞–Ω–∏–ª—å–Ω—ã–π —ç–∫—Å—Ç—Ä–∞–∫—Ç: 1/2 —á–∞–π–Ω–æ–π –ª–æ–∂–∫–∏
    –°–ª–∞–¥–∫–∏–π –ø–æ–¥—Å–ª–∞—Å—Ç–∏—Ç–µ–ª—å –ø–æ –≤–∫—É—Å—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–µ–≤–∏—è)
    –°–≤–µ–∂–∏–µ —è–≥–æ–¥—ã (–ª—é–±—ã–µ –Ω–∞ –≤–∞—à –≤—ã–±–æ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–Ω–∏–∫–∞, –∫–ª—É–±–Ω–∏–∫–∞): 100–≥
    –ù–µ–º–Ω–æ–≥–æ –≤–æ–¥—ã –∏–ª–∏ —è–≥–æ–¥–Ω–æ–≥–æ —Å–æ–∫–∞ –¥–ª—è —Å–æ—É—Å–∞
    –¶–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π –∫—É—Å-–∫—É—Å: 60–≥
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ extra virgin: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –¶—É–∫–∏–Ω–∏: 1 –º–∞–ª–µ–Ω—å–∫–∞—è
    –ë–æ–ª–≥–∞—Ä—Å–∫–∏–π –ø–µ—Ä–µ—Ü: 1 —à—Ç—É–∫–∞
    –ß–µ—Ä—Ä–∏ –ø–æ–º–∏–¥–æ—Ä—ã: 5-6 —à—Ç—É–∫
    –ê—Ä–æ–º–∞—Ç–Ω—ã–µ —Ç—Ä–∞–≤—ã (—Ä–æ–∑–º–∞—Ä–∏–Ω, —Ç–∏–º—å—è–Ω): –ø–æ –≤–∫—É—Å—É
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –ì–æ—Ä—Å—Ç—å —è–≥–æ–¥ (–∫–ª—É–±–Ω–∏–∫–∞, —á–µ—Ä–Ω–∏–∫–∞, –º–∞–ª–∏–Ω–∞): –æ–∫–æ–ª–æ 100–≥
    –ì–æ—Ä—Å—Ç—å –æ—Ä–µ—Ö–æ–≤ (–º–∏–Ω–¥–∞–ª—å, –≥—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏): –æ–∫–æ–ª–æ 30–≥
    –§–∏–ª–µ –∫—É—Ä–∏–Ω–æ–π –≥—Ä—É–¥–∫–∏: 150–≥
    –ö–∏–Ω–æ–∞: 50–≥ (—Å—É—Ö–æ–π –≤–µ—Å)
    –û–≥—É—Ä–µ—Ü: 1 —à—Ç—É–∫–∞
    –ü–æ–º–∏–¥–æ—Ä—ã: 2 —à—Ç—É–∫–∏
    –õ–∏—Å—Ç—å—è —à–ø–∏–Ω–∞—Ç–∞ –∏–ª–∏ —Å–∞–ª–∞—Ç–∞: 1 –≥–æ—Ä—Å—Ç—å
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –õ–∏–º–æ–Ω–Ω—ã–π —Å–æ–∫: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü, –ª—é–±–∏–º—ã–µ —Ç—Ä–∞–≤—ã –¥–ª—è –º–∞—Ä–∏–Ω–∞–¥–∞ –∏ –∑–∞–ø—Ä–∞–≤–∫–∏
    –ú–∏–Ω–¥–∞–ª—å: 30–≥
    –ú–æ—Ä—Å–∫–∞—è —Å–æ–ª—å: —â–µ–ø–æ—Ç–∫–∞
    –Ø–π—Ü–∞: 3 —à—Ç—É–∫–∏
    –°–≤–µ–∂–∏–π —à–ø–∏–Ω–∞—Ç: 1 –≥–æ—Ä—Å—Ç—å
    –ü–æ–º–∏–¥–æ—Ä—ã —á–µ—Ä—Ä–∏: 100–≥
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –ù–µ–º–Ω–æ–≥–æ —Å—ã—Ä–∞ —Ñ–µ—Ç–∞ –∏–ª–∏ –º–æ—Ü–∞—Ä–µ–ª–ª–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): 30–≥
    –ë–æ–ª–≥–∞—Ä—Å–∫–∏–π –ø–µ—Ä–µ—Ü: 2 —à—Ç—É–∫–∏
    –ö–∏–Ω–æ–∞: 50–≥
    –°–ø–∞—Ä–∂–∞: 50–≥
    –ú–æ—Ä–∫–æ–≤—å: 1 –º–∞–ª–µ–Ω—å–∫–∞—è
    –ö—É–∫—É—Ä—É–∑–∞ (–≤–∞—Ä–µ–Ω–∞—è –∏–ª–∏ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–∞—è): 50–≥
    –§–µ—Ç–∞ –∏–ª–∏ –≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–π —Å—ã—Ä: 30–≥
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü, –ª—é–±–∏–º—ã–µ —Ç—Ä–∞–≤—ã –ø–æ –≤–∫—É—Å—É
    –ì—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏: 15–≥
    –ú–∏–Ω–¥–∞–ª—å: 15–≥
    –°—É—à–µ–Ω—ã–µ –∫–ª—é–∫–≤–∞ –∏–ª–∏ –∏–Ω–∂–∏—Ä (–∏–ª–∏ –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ —Å—É—à–µ–Ω—ã–µ —Ñ—Ä—É–∫—Ç—ã –Ω–∞ –≤–∞—à –≤—ã–±–æ—Ä): 20–≥
    –ö–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—É–Ω–µ—Ü –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º —Å–æ–∫—É: 100–≥
    –ö–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–æ–±—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–∞—Å–Ω—ã–µ –∏–ª–∏ –±–µ–ª—ã–µ): 150–≥
    –°–≤–µ–∂–∏–π –æ–≥—É—Ä–µ—Ü: 1 —à—Ç—É–∫–∞ (—Å—Ä–µ–¥–Ω–∏–π)
    –°–ª–∞–¥–∫–∏–π –ø–µ—Ä–µ—Ü: 1 —à—Ç—É–∫–∞
    –ß–µ—Ä–Ω—ã–µ –º–∞—Å–ª–∏–Ω—ã: 30–≥
    –ö—Ä–∞—Å–Ω—ã–π –ª—É–∫: 1/4 —à—Ç—É–∫–∏
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ extra virgin: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–æ–∫ –ª–∏–º–æ–Ω–∞: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü, —Å–≤–µ–∂–∞—è –∑–µ–ª–µ–Ω—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∞–∑–∏–ª–∏–∫ –∏–ª–∏ —É–∫—Ä–æ–ø) –ø–æ –≤–∫—É—Å—É
    –ö–µ—Ñ–∏—Ä (1,5-2% –∂–∏—Ä–Ω–æ—Å—Ç–∏): 200 –º–ª
    –Ø–±–ª–æ–∫–æ: 1/2 —Å—Ä–µ–¥–Ω–µ–≥–æ
    –ë–∞–Ω–∞–Ω: 1/2 —Å—Ä–µ–¥–Ω–µ–≥–æ
    –ù–µ—Å–∫–æ–ª—å–∫–æ –ª–∏—Å—Ç–æ—á–∫–æ–≤ –º—è—Ç—ã
    –ú–µ–¥ (–ø–æ –∂–µ–ª–∞–Ω–∏—é): 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –ì—Ä–µ—á–Ω–µ–≤–∞—è –∫—Ä—É–ø–∞ (–∑–∞—Ä–∞–Ω–µ–µ –∑–∞–º–æ—á–µ–Ω–Ω–∞—è –Ω–∞ –Ω–æ—á—å): 60–≥
    –ì—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏: 20–≥
    –ú–∏–Ω–¥–∞–ª—å: 20–≥
    –°–≤–µ–∂–∏–µ —Ñ—Ä—É–∫—Ç—ã –ø–æ –≤—ã–±–æ—Ä—É (—è–±–ª–æ–∫–æ, –≥—Ä—É—à–∞, –±–∞–Ω–∞–Ω): 1 —à—Ç—É–∫–∞
    –ô–æ–≥—É—Ä—Ç –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): 100 –º–ª
    –ö–æ—Ä–∏—Ü–∞: 1/4 —á–∞–π–Ω–æ–π –ª–æ–∂–∫–∏
    –õ—é–±—ã–µ —è–≥–æ–¥—ã –¥–ª—è –¥–µ–∫–æ—Ä–∞: 50–≥
    –§–∏–ª–µ —Ç—Ä–µ—Å–∫–∏: 200–≥
    –ú–æ–ª–æ–¥–æ–π –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å: 200–≥
    –°–ø–∞—Ä–∂–∞: 100–≥
    –ú–∏–Ω–∏ –º–æ—Ä–∫–æ–≤—å: 100–≥
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ extra virgin: 2 —Å—Ç–æ–ª–æ–≤—ã–µ –ª–æ–∂–∫–∏
    –õ–∏–º–æ–Ω: 1 —à—Ç—É–∫–∞
    –ß–µ—Å–Ω–æ–∫: 2 –∑—É–±—á–∏–∫–∞ (–µ—Å–ª–∏ –≤—ã –Ω–µ –ø—Ä–æ—Ç–∏–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü, —Ç—Ä–∞–≤—ã –ø–æ –≤–∫—É—Å—É (—Ç–∏–º—å—è–Ω, —Ä–æ–∑–º–∞—Ä–∏–Ω)
    –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –∫–µ—Ñ–∏—Ä (1,5-2% –∂–∏—Ä–Ω–æ—Å—Ç–∏): 200 –º–ª
    –ú–æ–ª–æ—Ç–æ–µ –ª—å–Ω—è–Ω–æ–µ —Å–µ–º—è: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–≤–µ–∂–∏–µ –∏–ª–∏ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ —è–≥–æ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞–ª–∏–Ω–∞, —á–µ—Ä–Ω–∏–∫–∞): 50–≥
    –ú–µ–¥ (–ø–æ –∂–µ–ª–∞–Ω–∏—é, –∏—Å—Ö–æ–¥—è –∏–∑ –≤–∞—à–∏—Ö –¥–∏–µ—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π): 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –ö–∏–Ω–æ–∞: 70–≥
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –õ–∏–º–æ–Ω–Ω—ã–π —Å–æ–∫: 2 —Å—Ç–æ–ª–æ–≤—ã–µ –ª–æ–∂–∫–∏
    –û–≥—É—Ä–µ—Ü: 1 –º–∞–ª–µ–Ω—å–∫–∏–π
    –ü–æ–º–∏–¥–æ—Ä—ã —á–µ—Ä—Ä–∏: 70–≥
    –ö—Ä–∞—Å–Ω—ã–π –ª—É–∫: 1/4 —Å—Ä–µ–¥–Ω–µ–≥–æ
    –ú–∞—Å–ª–∏–Ω—ã –±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫: 30–≥
    –§–µ—Ç–∞: 50–≥
    –°–æ–ª—å, —á–µ—Ä–Ω—ã–π –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –ó–µ–ª–µ–Ω—å –¥–ª—è —É–∫—Ä–∞—à–µ–Ω–∏—è (–ø–µ—Ç—Ä—É—à–∫–∞, —É–∫—Ä–æ–ø, –º—è—Ç–∞)
    –û–≤—Å—è–Ω—ã–µ —Ö–ª–æ–ø—å—è: 100–≥
    –ò–∑—é–º: 30–≥
    –ú–∏–Ω–¥–∞–ª—å: 20–≥
    –ì—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏: 20–≥
    –ö—É–Ω–∂—É—Ç–Ω—ã–µ —Å–µ–º–µ—á–∫–∏: 10–≥
    –ú–µ–¥ (–∏–ª–∏ –∞–≥–∞–≤—ã —Å–∏—Ä–æ–ø –¥–ª—è –∑–∞–º–µ–Ω—ã): 2 —Å—Ç–æ–ª–æ–≤—ã–µ –ª–æ–∂–∫–∏
    –ö–æ–∫–æ—Å–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –Ø–π—Ü–∞: 2 —à—Ç—É–∫–∏
    –ü–æ–º–∏–¥–æ—Ä: 1 —Å—Ä–µ–¥–Ω–∏–π
    –°–ª–∞–¥–∫–∏–π –ø–µ—Ä–µ—Ü: 1 —à—Ç—É–∫–∞
    –®–ø–∏–Ω–∞—Ç: 1 –≥–æ—Ä—Å—Ç—å
    –§–µ—Ç–∞: 30–≥
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –õ—é–±–∏–º—ã–µ —Ç—Ä–∞–≤—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∞–∑–∏–ª–∏–∫ –∏–ª–∏ –æ—Ä–µ–≥–∞–Ω–æ)
    –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞: 150–≥
    –ö—É—Å–∫—É—Å: 50–≥ (—Å—É—Ö–æ–π –≤–µ—Å)
    –ë—Ä–æ–∫–∫–æ–ª–∏: 100–≥
    –ó–µ–ª–µ–Ω—ã–π –≥–æ—Ä–æ—à–µ–∫ (—Å–≤–µ–∂–∏–π –∏–ª–∏ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–π): 50–≥
    –®–ø–∏–Ω–∞—Ç: 1 –≥–æ—Ä—Å—Ç—å
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –õ–∏–º–æ–Ω: 1/4 —à—Ç—É–∫–∏
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü, –ø—Ä—è–Ω—ã–µ —Ç—Ä–∞–≤—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–æ–∑–º–∞—Ä–∏–Ω –∏–ª–∏ —Ç–∏–º—å—è–Ω) –ø–æ –≤–∫—É—Å—É
    –°–≤–µ–∂–∏–π –æ–≥—É—Ä–µ—Ü: 1 —Å—Ä–µ–¥–Ω–∏–π
    –õ–∏—Å—Ç—å—è –º—è—Ç—ã: 5-10 —à—Ç—É–∫
    –õ–∏–º–æ–Ω–Ω—ã–π —Å–æ–∫: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –ú–∏–Ω–µ—Ä–∞–ª—å–Ω–∞—è –≤–æ–¥–∞ –±–µ–∑ –≥–∞–∑–∞: 200 –º–ª
    –õ–µ–¥ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)
    –ö–∏–Ω–æ–∞: 60–≥ (—Å—É—Ö–æ–π –≤–µ—Å)
    –ë—É–ª—å–æ–Ω –æ–≤–æ—â–Ω–æ–π: 200 –º–ª
    –ú–æ—Ä–∫–æ–≤—å: 1 —Å—Ä–µ–¥–Ω—è—è
    –°–ª–∞–¥–∫–∏–π –ø–µ—Ä–µ—Ü: 1 —à—Ç—É–∫–∞
    –ë—Ä–æ–∫–∫–æ–ª–∏: 100–≥
    –®–ø–∏–Ω–∞—Ç: 1 –≥–æ—Ä—Å—Ç—å
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –ì—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏: 20–≥
    –ú–∏–Ω–¥–∞–ª—å: 20–≥
    –ò–∑—é–º: 15–≥
    –ö—É—Ä–∞–≥–∞: 15–≥
    –°–µ–º–µ–Ω–∞ –ª—å–Ω–∞: 10–≥
    –¶–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π —Ö–ª–µ–±: 1 –∫—É—Å–æ–∫
    –ê–≤–æ–∫–∞–¥–æ: 1/2 —à—Ç—É–∫–∏
    –Ø–π—Ü–æ: 1 —à—Ç—É–∫–∞
    –ü–æ–º–∏–¥–æ—Ä —á–µ—Ä—Ä–∏: 5 —à—Ç—É–∫
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —á–∞–π–Ω–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –§–∏–ª–µ —Ñ–æ—Ä–µ–ª–∏: 200–≥
    –°–ª–∞–¥–∫–∏–π –ø–µ—Ä–µ—Ü: 1 —à—Ç—É–∫–∞
    –°–ø–∞—Ä–∂–∞: 100–≥
    –¶—É–∫–∏–Ω–∏ (–µ—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –µ–≥–æ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ; –∏–Ω–∞—á–µ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –±—Ä–æ–∫–∫–æ–ª–∏): 100–≥
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 2 —Å—Ç–æ–ª–æ–≤—ã–µ –ª–æ–∂–∫–∏
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –õ–∏–º–æ–Ω –¥–ª—è –ø–æ–¥–∞—á–∏
    –°–ø–µ–ª–æ–µ –∞–≤–æ–∫–∞–¥–æ: 1/2 —à—Ç—É–∫–∏
    –®–ø–∏–Ω–∞—Ç: 1 –≥–æ—Ä—Å—Ç—å
    –ì—Ä–µ—Ü–∫–∏–µ –æ—Ä–µ—Ö–∏: 15–≥
    –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –π–æ–≥—É—Ä—Ç –∏–ª–∏ –∫–µ—Ñ–∏—Ä: 100 –º–ª
    –í–æ–¥–∞ –∏–ª–∏ –∫–æ–∫–æ—Å–æ–≤–∞—è –≤–æ–¥–∞: 100 –º–ª
    –ù–µ—Å–∫–æ–ª—å–∫–æ –ª–∏—Å—Ç–∏–∫–æ–≤ –º—è—Ç—ã –¥–ª—è —Å–≤–µ–∂–µ—Å—Ç–∏
    –ö–∏–Ω–æ–∞: 50–≥ (—Å—É—Ö–æ–π –≤–µ—Å)
    –§–∏–ª–µ –ª–æ—Å–æ—Å—è: 150–≥
    –°–∞–ª–∞—Ç–Ω—ã–µ –ª–∏—Å—Ç—å—è (–ª–∞–¥–∞–Ω—å, —à–ø–∏–Ω–∞—Ç, —Ä—É–∫–∫–æ–ª–∞): 100–≥
    –û–≥—É—Ä–µ—Ü: 1 —Å—Ä–µ–¥–Ω–∏–π
    –ü–æ–º–∏–¥–æ—Ä—ã —á–µ—Ä—Ä–∏: 100–≥
    –õ–∏–º–æ–Ω: 1/2 —à—Ç—É–∫–∏
    –û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ: 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –°–æ–ª—å, –ø–µ—Ä–µ—Ü –ø–æ –≤–∫—É—Å—É
    –Ø–±–ª–æ–∫–æ: 1 —Å—Ä–µ–¥–Ω–µ–µ
    –ì—Ä—É—à–∞: 1 —Å—Ä–µ–¥–Ω—è—è
    –ú–∞–Ω–¥–∞—Ä–∏–Ω—ã: 2 —à—Ç—É–∫–∏
    –û—Ä–µ—Ö–∏ (–≥—Ä–µ—Ü–∫–∏–µ –∏–ª–∏ –∞—Ä–∞—Ö–∏—Å): 30–≥
    –¶–∏—Ç—Ä—É—Å–æ–≤—ã–π —Å–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ –ª–∏–º–æ–Ω–∞): 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –ú–∏–Ω—Ç –∏–ª–∏ –º—è—Ç–∞ –¥–ª—è —É–∫—Ä–∞—à–µ–Ω–∏—è
    –û–≤—Å—è–Ω—ã–µ —Ö–ª–æ–ø—å—è: 60–≥
    –í–æ–¥–∞: 150 –º–ª
    –ü–µ—Ä—Å–∏–∫ (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ñ—Ä—É–∫—Ç—ã): 1 —Å—Ä–µ–¥–Ω–∏–π
    –Ø–≥–æ–¥—ã (–ª—é–±—ã–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª—É–±–Ω–∏–∫–∞ –∏–ª–∏ –º–∞–ª–∏–Ω–∞): 100–≥
    –ì—Ä–µ—á–µ—Å–∫–∏–π –π–æ–≥—É—Ä—Ç: 100–≥
    –û—Ä–µ—Ö–∏ –∏–ª–∏ —Å–µ–º–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ–º–µ–Ω–∞ —á–∏–∞ –∏–ª–∏ –ª—å–Ω—è–Ω—ã–µ —Å–µ–º–µ–Ω–∞): 1 —Å—Ç–æ–ª–æ–≤–∞—è –ª–æ–∂–∫–∞
    –ú–µ–¥ (–ø—Ä–∏ –í–∞—à–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–∏ –Ω–∞ –º–µ–¥, –µ–≥–æ –º–æ–∂–Ω–æ –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å—Ç–µ–≤–∏—é –ø–æ –≤–∫—É—Å—É)
    `,
      },
    ]);
  }

  async createThread(messages: MessageCreateParams[]): Promise<string> {
    console.log("create thread", messages);
    const thread = await this.openAi.beta.threads.create({ messages });
    return thread.id;
  }

  async addThreadMessage(threadId: string, message: MessageCreateParams) {
    console.log("add message to thread");
    await this.openAi.beta.threads.messages.create(threadId, message);
  }

  async getThreadMessages(threadId: string): Promise<ThreadMessagesPage> {
    console.log("get messages from thread");
    return await this.openAi.beta.threads.messages.list(threadId);
  }

  async runAssistant(threadId: string, assistantId: string) {
    console.log("run assistant");
    return await this.openAi.beta.threads.runs.create(threadId, {
      assistant_id: assistantId,
      model: "gpt-4-turbo-preview",
      tools: [{ type: "retrieval" }],
    });
  }

  async checkRun(threadId: string, runId: string): Promise<Run> {
    console.log("check run");
    return await this.openAi.beta.threads.runs.retrieve(threadId, runId);
  }
}
